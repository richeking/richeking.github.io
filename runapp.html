 <!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<title>Google App Script Runner</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  color: #ddd;
  background-color: #3a3a3a;
}
#log {
  padding-top:5vh;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  font-family: monospace;
  font-size: 3vmin;
}
.error {
  color: #faa;
}
</style>
</head>
<body>
<div id="log"></div>
<script>
(async function(window) {
  const gasBaseUrl = "https://script.google.com/macros/s/";
  const appScriptDns = gasBaseUrl + "AKfycbxc1DjJcrU9vbMHRG73uAiJwvjlWwK7orSTdk-Lc5ihBVFrWo4vYPc1nbRCFJp1AKPR/exec";

  
  //log error message to console and to page #log element
  function logError(error) {
    console.error(error);
    let logLine = document.createElement("div");
    logLine.classList.add("error");
    logLine.textContent = error;
    document.getElementById("log").appendChild(logLine);
  }
  
  //log message to #log element
  function log(msg) {
    let logLine = document.createElement("div");
    logLine.textContent = msg;
    document.getElementById("log").appendChild(logLine);
  }
  
  log("Welcome to google app script runner");
  let rawResponse;
  try {
    rawResponse = await fetch(appScriptDns + window.location.search);
  } catch (ex) {
    logError("Failed to parse app script dns response");
    logError(ex);
    return;
  }
  
  let dnsEntry;
  try {
    dnsEntry = await rawResponse.json();
  } catch (ex) {
    logError("Failed to parse app script dns response");
    logError(ex);
    return;
  }

  if ( dnsEntry.status != 200 ) {
    logError(dnsEntry.status + " " + dnsEntry.message);
    return;
  }
  
  log("Loading app script, please wait");
  let appHtml;
  try {
    let appSrc = "https://script.google.com/macros/s/" +  dnsEntry.message + window.location.search;
    let appPage = await fetch(appSrc);
    appHtml = await appPage.text();
  } catch (ex) {
    logError("Failed to get app script html content");
    logError(error);
  }
  document.open();
  document.write(appHtml);
  document.close();
})(this);
</script>

</body>
</html>
